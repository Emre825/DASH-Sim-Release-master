<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DASH-Sim Manual: DTPM_utils.py Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="DARPA_logo.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DASH-Sim Manual
   </div>
   <div id="projectbrief">Domain-Focused Advanced Software-Reconfigurable Heterogenous SoC Simulator</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_d_t_p_m__utils_8py_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">DTPM_utils.py</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_d_t_p_m__utils_8py.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno"><a class="line" href="namespace_d_t_p_m__utils.html">    1</a></span>&#160;<span class="stringliteral">&#39;&#39;&#39;!</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="stringliteral">@brief This file contains functions that are used by the DTPM module.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160; </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="keyword">import</span> multiprocessing</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="keyword">import</span> itertools</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="keyword">import</span> numpy <span class="keyword">as</span> np</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="keyword">from</span> itertools <span class="keyword">import</span> islice</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="keyword">import</span> sys</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keyword">import</span> math</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"># matplotlib.use(&#39;Agg&#39;)</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="keyword">import</span> os</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keyword">from</span> sys <span class="keyword">import</span> platform</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keyword">from</span> statistics <span class="keyword">import</span> mean</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="keyword">import</span> csv</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keyword">import</span> copy</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keyword">import</span> re, shutil, tempfile</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keyword">import</span> DTPM_power_models</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">import</span> common</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="keyword">import</span> DASH_Sim_v0</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">import</span> DASH_Sim_utils</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="keyword">import</span> DTPM_policies</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="namespace_d_t_p_m__utils.html#a697a0f6bcf116bd0335f8bb2fc10c925">   26</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespace_d_t_p_m__utils.html#a697a0f6bcf116bd0335f8bb2fc10c925">run_sim_initial_dataset</a>(sim_params):</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;!</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="stringliteral">    Call the simulator with specific parameters in order to generate the dataset that will be used for the DTPM policies.</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="stringliteral">    This method is called multiple times in parallel, based on the availability of CPU cores in the host machine.</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="stringliteral">    Each simulation executes and obtains the results from a single snippet (one sample in the dataset).</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="stringliteral">    @param sim_params: Simulation configurations that change among different simulations, for instance, DVFS config and snippet.</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    sim_num, DVFS_cfg_list, job_config, N_little, N_big, num_PEs = sim_params</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    common.CLEAN_TRACES = <span class="keyword">False</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    common.generate_complete_trace = <span class="keyword">True</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    common.TRACE_PES = <span class="keyword">False</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    common.TRACE_IL_PREDICTIONS = <span class="keyword">False</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    common.TRACE_TEMPERATURE = <span class="keyword">False</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    common.enable_real_time_constraints = <span class="keyword">False</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    common.enable_num_cores_prediction = <span class="keyword">False</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    common.DVFS_cfg_list = DVFS_cfg_list</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    common.job_list = job_config</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordflow">if</span> job_config == []:</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        common.current_job_list = []</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        common.current_job_list = job_config[0]</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        common.snippet_size = sum(job_config[0])</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        common.max_num_jobs = common.snippet_size * len(job_config)</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    common.gen_trace_capacity_little = N_little</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    common.gen_trace_capacity_big = N_big</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    common.sim_ID = sim_num</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    common.num_PEs_TRACE = num_PEs</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    common.trace_file_num = os.getpid()</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="namespace_d_a_s_h___sim__v0.html#a635d4b6a4a16ab508897a2089ca4fa05">DASH_Sim_v0.run_simulator</a>()</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="namespace_d_t_p_m__utils.html#a3c794b8a9df741fee23a0173d1767bb0">   57</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespace_d_t_p_m__utils.html#a3c794b8a9df741fee23a0173d1767bb0">run_parallel_sims</a>(DVFS_config_list, N_little_list, N_big_list, N_jobs, N_applications, heterogeneous_PEs=False):</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;!</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="stringliteral">    Run all possible combinations for the provided frequency points in parallel.</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="stringliteral">    Create the simulation parameters for all simulations.</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="stringliteral">    @param DVFS_config_list: List of all DVFS configurations to be executed</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="stringliteral">    @param N_little_list: List of all number of little cores to be executed</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="stringliteral">    @param N_big_list: List of all number of big cores to be executed</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="stringliteral">    @param N_jobs: Number of jobs per snippet (snippet_size)</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="stringliteral">    @param N_applications: Number of applications</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="stringliteral">    @param heterogeneous_PEs: Flag to identify whether a heterogeneous SoC configuration is being used</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">if</span> heterogeneous_PEs:</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        DVFS_config_list_prod = itertools.product(*DVFS_config_list)</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        DVFS_config_list_prod = itertools.product(DVFS_config_list, repeat=common.num_PEs_TRACE)</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    job_list = <a class="code" href="namespace_d_t_p_m__utils.html#ac1dcbad85c5db3c717aba9fbb47d9156">multinomial_combinations</a>(N_jobs, N_applications)</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    num_sim, config_list = <a class="code" href="namespace_d_t_p_m__utils.html#a859d1e4c979be2758bbf67f936961ea0">merge_hardware_counters_multiple_applications</a>(DVFS_config_list_prod, N_little_list, N_big_list, job_list)</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    print(<span class="stringliteral">&quot;Number of job configurations:&quot;</span>, len(job_list))</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    print(<span class="stringliteral">&quot;Number of simulations:&quot;</span>, num_sim)</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    pool = multiprocessing.Pool(min(num_sim, multiprocessing.cpu_count()))</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment"># Run all simulations</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    pool.map(run_sim_initial_dataset, config_list)</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    pool.close()</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">return</span> 0</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="namespace_d_t_p_m__utils.html#a859d1e4c979be2758bbf67f936961ea0">   86</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespace_d_t_p_m__utils.html#a859d1e4c979be2758bbf67f936961ea0">merge_hardware_counters_multiple_applications</a>(DVFS_config_list_prod, N_little_list, N_big_list, job_list):</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;!</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="stringliteral">    Merge the hardware counters from multiple applications to create the snippet profile.</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="stringliteral">    @param DVFS_config_list_prod: List of all combinations of the available DVFS configs for all clusters</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="stringliteral">    @param N_little_list: List of all number of little cores</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="stringliteral">    @param N_big_list: List of all number of big cores</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="stringliteral">    @param job_list: Number of jobs per snippet</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="stringliteral">    @return The number of simulations and the list of configurations that will be executed</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    num_sim = 0</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    pool = multiprocessing.Pool(min(len(job_list)*len(N_big_list)*len(N_little_list), multiprocessing.cpu_count()))</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment"># First prepare and merge the different HW counter trace files into a single CSV</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="namespace_d_t_p_m__utils.html#a09a93a8e21f05873ab9bf11a3fa78e9a">merge_hardware_counters_single_app</a>()</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    hardware_counters_single_app = pd.read_csv(common.HARDWARE_COUNTERS_SINGLE_APP)</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment"># Create dataframe for merged counters</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    merged_counters = pd.DataFrame(columns=hardware_counters_single_app.columns)</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    merged_counters = merged_counters.drop([<span class="stringliteral">&#39;Workload Name&#39;</span>], axis=1)</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    merged_counters.insert(loc=0, column=<span class="stringliteral">&#39;Job List&#39;</span>, value=<span class="stringliteral">&#39;&#39;</span>)</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    params = []</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    print(<span class="stringliteral">&quot;Merging hardware counters...&quot;</span>)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">for</span> config <span class="keywordflow">in</span> DVFS_config_list_prod:</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keywordflow">if</span> len(config) &lt; 2:</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            print(<span class="stringliteral">&quot;[E] Trace generation must have at least little and big clusters, check run_parallel_sims method&quot;</span>)</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            sys.exit()</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        freq_little = float(config[0].split(<span class="stringliteral">&#39;-&#39;</span>)[1]) / 1000</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        freq_big = float(config[1].split(<span class="stringliteral">&#39;-&#39;</span>)[1]) / 1000</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keywordflow">for</span> N_little <span class="keywordflow">in</span> N_little_list:</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <span class="keywordflow">for</span> N_big <span class="keywordflow">in</span> N_big_list:</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                <span class="keywordflow">for</span> job_config <span class="keywordflow">in</span> job_list:</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                    params.append([num_sim, job_config, N_little, N_big, freq_little, freq_big, config, hardware_counters_single_app])</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                    num_sim += 1</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    config_list, merged_counters_list = zip(*pool.map(create_config_list_job_list, params))</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    merged_counters = merged_counters.append(pd.DataFrame(merged_counters_list, columns=merged_counters.columns), ignore_index=<span class="keyword">True</span>)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    merged_counters.to_csv(common.HARDWARE_COUNTERS_TRACE, index=<span class="keyword">False</span>)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    print(len(config_list))</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    pool.close()</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">return</span> (num_sim, config_list)</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="namespace_d_t_p_m__utils.html#a767b2af47d4348383131e98dd6726ea0">  127</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespace_d_t_p_m__utils.html#a767b2af47d4348383131e98dd6726ea0">create_dataset_IL_DTPM</a>(timestamp, PEs):</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;!</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="stringliteral">    Create the dataset used for the IL DTPM policies</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="stringliteral">    @param timestamp: Current timestamp</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="stringliteral">    @param PEs: List of PEs</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">if</span> (common.CREATE_DATASET_DTPM):</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordflow">if</span> <span class="keywordflow">not</span> os.path.exists(common.HARDWARE_COUNTERS_TRACE):</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            print(<span class="stringliteral">&quot;[E] Hardware counters file was not found. This file is created by generate_traces.py and it is needed for creating the DTPM dataset.&quot;</span>)</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            print(<span class="stringliteral">&quot;[E] If not running an IL policy, please disable the create_dataset_DTPM flag&quot;</span>)</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            sys.exit()</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">if</span> common.job_list == []:</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            print(<span class="stringliteral">&quot;[W] A job_list is required to create the IL dataset, please add a job_list or disable the create_dataset_DTPM flag.&quot;</span>)</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            create_header = <span class="keyword">False</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <span class="keywordflow">if</span> <span class="keywordflow">not</span> (os.path.exists(common.DATASET_FILE_DTPM.split(<span class="stringliteral">&quot;.&quot;</span>)[0] + <span class="stringliteral">&quot;__&quot;</span> + str(common.trace_file_num) + <span class="stringliteral">&quot;.csv&quot;</span>)):</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                <span class="comment"># Create the CSV header</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                create_header = <span class="keyword">True</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <span class="keyword">with</span> open(common.DATASET_FILE_DTPM.split(<span class="stringliteral">&quot;.&quot;</span>)[0] + <span class="stringliteral">&quot;__&quot;</span> + str(common.trace_file_num) + <span class="stringliteral">&quot;.csv&quot;</span>, <span class="stringliteral">&#39;a&#39;</span>, newline=<span class="stringliteral">&#39;&#39;</span>) <span class="keyword">as</span> csvfile:</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                dataset = csv.writer(csvfile, delimiter=<span class="stringliteral">&#39;,&#39;</span>)</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                <span class="keywordflow">if</span> common.generate_complete_trace:</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                    policy_freq_list = []</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                    <span class="keywordflow">for</span> cluster <span class="keywordflow">in</span> common.ClusterManager.cluster_list:</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                        <span class="keywordflow">if</span> cluster.type != <span class="stringliteral">&quot;MEM&quot;</span>:</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                            policy_freq_list.append(cluster.policy_frequency / 1000)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                    current_state = <a class="code" href="namespace_d_a_s_h___sim__utils.html#a12301b830278c9ed9494270c6557afd3">DASH_Sim_utils.get_system_state</a>(PEs, input_freq=policy_freq_list)</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                    current_state = <a class="code" href="namespace_d_a_s_h___sim__utils.html#a12301b830278c9ed9494270c6557afd3">DASH_Sim_utils.get_system_state</a>(PEs)</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                total_energy_consumption = 0</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                <span class="keywordflow">for</span> cluster <span class="keywordflow">in</span> common.ClusterManager.cluster_list:</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                    <span class="keywordflow">if</span> cluster.type != <span class="stringliteral">&quot;MEM&quot;</span>:</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                        current_state[<span class="stringliteral">&#39;Utilization_PE_&#39;</span> + str(cluster.ID)] = 0</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                <span class="keywordflow">for</span> PE <span class="keywordflow">in</span> PEs:</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                    cluster = common.ClusterManager.cluster_list[PE.cluster_ID]</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                    <span class="keywordflow">if</span> cluster.type != <span class="stringliteral">&quot;MEM&quot;</span>:</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                        exec_time_samples = len(PE.utilization_list) * common.sampling_rate</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                        utilization_time = 0</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                        <span class="keywordflow">for</span> utilization <span class="keywordflow">in</span> PE.utilization_list:</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                            utilization_time += common.sampling_rate * utilization</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                        current_state[<span class="stringliteral">&#39;Utilization_PE_&#39;</span> + str(PE.cluster_ID)] += utilization_time / exec_time_samples</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                        PE.utilization_list = []</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                        total_energy_consumption += PE.snippet_energy</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                <span class="keywordflow">for</span> cluster <span class="keywordflow">in</span> common.ClusterManager.cluster_list:</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                    <span class="keywordflow">if</span> cluster.type != <span class="stringliteral">&quot;MEM&quot;</span>:</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                        current_state[<span class="stringliteral">&#39;Utilization_PE_&#39;</span> + str(cluster.ID)] /= len(cluster.PE_list)</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                snippet_exec_time = timestamp - common.snippet_start_time</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                current_state[<span class="stringliteral">&#39;Max_temp&#39;</span>] = max(common.snippet_temp_list)</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                current_state[<span class="stringliteral">&#39;Min_temp&#39;</span>] = min(common.snippet_temp_list)</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                current_state[<span class="stringliteral">&#39;Avg_temp&#39;</span>] = mean(common.snippet_temp_list)</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                current_state[<span class="stringliteral">&#39;Throttling State&#39;</span>] = common.snippet_throttle</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                current_state[<span class="stringliteral">&#39;Execution Time (s)&#39;</span>] = snippet_exec_time * 1e-6</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                current_state[<span class="stringliteral">&#39;Energy Consumption (J)&#39;</span>] = total_energy_consumption</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                <span class="keywordflow">if</span> create_header == <span class="keyword">True</span>:</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                    header = []</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                    <span class="keywordflow">for</span> index, val <span class="keywordflow">in</span> current_state.iteritems():</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                        header.append(index)</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                    dataset.writerow(header)</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                dataset.writerow(current_state)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <span class="keywordflow">if</span> common.ClusterManager.cluster_list[0].DVFS == <span class="stringliteral">&quot;imitation-learning&quot;</span>:</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                <span class="comment"># Get oracle</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                oracle_row = common.oracle_config_dict[str(common.current_job_list)]</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                <span class="comment"># -- Freq</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                oracle_freq = []</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                <span class="keywordflow">for</span> cluster_ID <span class="keywordflow">in</span> range(len(common.ClusterManager.cluster_list) - 1):</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                    oracle_freq.append(oracle_row[<span class="stringliteral">&#39;FREQ_PE_&#39;</span> + str(cluster_ID) + <span class="stringliteral">&#39; (GHz)&#39;</span>])</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                <span class="comment"># -- Num_cores</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                oracle_num_cores = []</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                oracle_num_cores.append(oracle_row[<span class="stringliteral">&#39;N_little&#39;</span>])</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                oracle_num_cores.append(oracle_row[<span class="stringliteral">&#39;N_big&#39;</span>])</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                <span class="comment"># -- Regression</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                oracle_exec_time = current_state[<span class="stringliteral">&#39;Execution Time (s)&#39;</span>]</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                current_state_regression = copy.deepcopy(current_state)</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                current_state_regression = current_state_regression.drop([<span class="stringliteral">&#39;Execution Time (s)&#39;</span>])</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                <span class="keywordflow">if</span> common.aggregate_data_freq:</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                    <span class="comment"># Aggregate data</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                    <a class="code" href="namespace_d_t_p_m__policies.html#af07d973088cfe7873324ca30a30f52b2">DTPM_policies.aggregate_data</a>(<span class="stringliteral">&#39;freq&#39;</span>, copy.deepcopy(current_state), oracle_freq)</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                    common.aggregate_data_freq = <span class="keyword">False</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                <span class="keywordflow">if</span> common.aggregate_data_num_cores:</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                    <span class="comment"># Aggregate data</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                    <a class="code" href="namespace_d_t_p_m__policies.html#af07d973088cfe7873324ca30a30f52b2">DTPM_policies.aggregate_data</a>(<span class="stringliteral">&#39;num_cores&#39;</span>, copy.deepcopy(current_state), oracle_num_cores)</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                    common.aggregate_data_num_cores = <span class="keyword">False</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                <span class="keywordflow">if</span> common.aggregate_data_regression:</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                    <span class="comment"># Aggregate data</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                    <a class="code" href="namespace_d_t_p_m__policies.html#af07d973088cfe7873324ca30a30f52b2">DTPM_policies.aggregate_data</a>(<span class="stringliteral">&#39;regression&#39;</span>, current_state_regression, oracle_exec_time)</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                    common.aggregate_data_regression = <span class="keyword">False</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                <span class="keywordflow">if</span> common.enable_thermal_management:</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                    <a class="code" href="namespace_d_t_p_m__utils.html#a7a7c5a77471e4cf2477cc0a8df97b8d0">update_temperature_dataset</a>(<span class="stringliteral">&#39;freq&#39;</span>, copy.deepcopy(current_state), oracle_freq, <span class="stringliteral">&#39;complete&#39;</span>, PEs)</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                    <a class="code" href="namespace_d_t_p_m__utils.html#a7a7c5a77471e4cf2477cc0a8df97b8d0">update_temperature_dataset</a>(<span class="stringliteral">&#39;freq&#39;</span>, copy.deepcopy(current_state), oracle_freq, <span class="stringliteral">&#39;reduced&#39;</span>, PEs)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                    <span class="keywordflow">if</span> common.enable_num_cores_prediction:</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                        <a class="code" href="namespace_d_t_p_m__utils.html#a7a7c5a77471e4cf2477cc0a8df97b8d0">update_temperature_dataset</a>(<span class="stringliteral">&#39;num_cores&#39;</span>, copy.deepcopy(current_state), oracle_num_cores, <span class="stringliteral">&#39;complete&#39;</span>, PEs)</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                        <a class="code" href="namespace_d_t_p_m__utils.html#a7a7c5a77471e4cf2477cc0a8df97b8d0">update_temperature_dataset</a>(<span class="stringliteral">&#39;num_cores&#39;</span>, copy.deepcopy(current_state), oracle_num_cores, <span class="stringliteral">&#39;reduced&#39;</span>, PEs)</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                    <span class="keywordflow">if</span> common.enable_real_time_constraints:</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                        <a class="code" href="namespace_d_t_p_m__utils.html#a7a7c5a77471e4cf2477cc0a8df97b8d0">update_temperature_dataset</a>(<span class="stringliteral">&#39;regression&#39;</span>, current_state_regression, oracle_exec_time, <span class="stringliteral">&#39;complete&#39;</span>, PEs)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                        <a class="code" href="namespace_d_t_p_m__utils.html#a7a7c5a77471e4cf2477cc0a8df97b8d0">update_temperature_dataset</a>(<span class="stringliteral">&#39;regression&#39;</span>, current_state_regression, oracle_exec_time, <span class="stringliteral">&#39;reduced&#39;</span>, PEs)</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                    common.thermal_limit_violated = <span class="keyword">False</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="namespace_d_t_p_m__utils.html#a5d555ff323892aaf0f663ad6958026b5">  235</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespace_d_t_p_m__utils.html#a5d555ff323892aaf0f663ad6958026b5">create_config_list_job_list</a>(params):</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;!</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="stringliteral">    Read the hardware counter profiles and compute the snippet hardware counters</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="stringliteral">    @param params: Unique parameters that identify each configuration</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="stringliteral">    @return Snippet configuration and merged counters</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    num_sim, job_config, N_little, N_big, freq_little, freq_big, cfg_sample, hardware_counters_single_app = params</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    total_instructions = 0</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    total_cycles = 0</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    total_branch = 0</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    total_misses = 0</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    total_mem_access = 0</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    total_non_cache = 0</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordflow">for</span> job_ID, num_job <span class="keywordflow">in</span> enumerate(job_config):</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        sample = hardware_counters_single_app[(hardware_counters_single_app[<span class="stringliteral">&#39;Workload Name&#39;</span>] == job_ID) &amp;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                                              (hardware_counters_single_app[<span class="stringliteral">&#39;N_little&#39;</span>] == N_little) &amp;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                                              (hardware_counters_single_app[<span class="stringliteral">&#39;N_big&#39;</span>] == N_big) &amp;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                                              (hardware_counters_single_app[<span class="stringliteral">&#39;FREQ_PE_0 (GHz)&#39;</span>] == freq_little) &amp;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                                              (hardware_counters_single_app[<span class="stringliteral">&#39;FREQ_PE_1 (GHz)&#39;</span>] == freq_big)]</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keywordflow">if</span> len(sample) != 1:</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            print(<span class="stringliteral">&quot;[E] Invalid sample detected in the hardware counter file. The query must return 1 sample.&quot;</span>)</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            print(job_ID, N_little, N_big, freq_little, freq_big)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            sys.exit()</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        total_instructions += <a class="code" href="namespace_d_t_p_m__train__model.html#a85fef18c2b4b364897ad4be9ba9dcc6b">int</a>(sample[<span class="stringliteral">&#39;Instructions&#39;</span>]) * num_job</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        total_cycles += <a class="code" href="namespace_d_t_p_m__train__model.html#a85fef18c2b4b364897ad4be9ba9dcc6b">int</a>(sample[<span class="stringliteral">&#39;CPU Cycles&#39;</span>]) * num_job</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        total_branch += <a class="code" href="namespace_d_t_p_m__train__model.html#a85fef18c2b4b364897ad4be9ba9dcc6b">int</a>(sample[<span class="stringliteral">&#39;Branch Miss Prediction&#39;</span>]) * num_job</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        total_misses += <a class="code" href="namespace_d_t_p_m__train__model.html#a85fef18c2b4b364897ad4be9ba9dcc6b">int</a>(sample[<span class="stringliteral">&#39;Level 2 cache misses&#39;</span>]) * num_job</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        total_mem_access += <a class="code" href="namespace_d_t_p_m__train__model.html#a85fef18c2b4b364897ad4be9ba9dcc6b">int</a>(sample[<span class="stringliteral">&#39;Data Memory Access&#39;</span>]) * num_job</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        total_non_cache += <a class="code" href="namespace_d_t_p_m__train__model.html#a85fef18c2b4b364897ad4be9ba9dcc6b">int</a>(sample[<span class="stringliteral">&#39;Non-cache External Mem. Req.&#39;</span>]) * num_job</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    mt_merged_counter = {<span class="stringliteral">&#39;Job List&#39;</span>: str(list(job_config)),</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                          <span class="stringliteral">&#39;N_little&#39;</span>: N_little,</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                          <span class="stringliteral">&#39;N_big&#39;</span>: N_big,</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                          <span class="stringliteral">&#39;FREQ_PE_0 (GHz)&#39;</span>: freq_little,</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                          <span class="stringliteral">&#39;FREQ_PE_1 (GHz)&#39;</span>: freq_big,</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                          <span class="stringliteral">&#39;Instructions&#39;</span>: <a class="code" href="namespace_d_t_p_m__train__model.html#a85fef18c2b4b364897ad4be9ba9dcc6b">int</a>(total_instructions),</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                          <span class="stringliteral">&#39;CPU Cycles&#39;</span>: <a class="code" href="namespace_d_t_p_m__train__model.html#a85fef18c2b4b364897ad4be9ba9dcc6b">int</a>(total_cycles),</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                          <span class="stringliteral">&#39;Branch Miss Prediction&#39;</span>: <a class="code" href="namespace_d_t_p_m__train__model.html#a85fef18c2b4b364897ad4be9ba9dcc6b">int</a>(total_branch),</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                          <span class="stringliteral">&#39;Level 2 cache misses&#39;</span>: <a class="code" href="namespace_d_t_p_m__train__model.html#a85fef18c2b4b364897ad4be9ba9dcc6b">int</a>(total_misses),</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                          <span class="stringliteral">&#39;Data Memory Access&#39;</span>: <a class="code" href="namespace_d_t_p_m__train__model.html#a85fef18c2b4b364897ad4be9ba9dcc6b">int</a>(total_mem_access),</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                          <span class="stringliteral">&#39;Non-cache External Mem. Req.&#39;</span>: <a class="code" href="namespace_d_t_p_m__train__model.html#a85fef18c2b4b364897ad4be9ba9dcc6b">int</a>(total_non_cache)}</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    mt_config = (num_sim, cfg_sample, [list(job_config)], N_little, N_big, common.num_PEs_TRACE)</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">return</span> mt_config, mt_merged_counter</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno"><a class="line" href="namespace_d_t_p_m__utils.html#a09a93a8e21f05873ab9bf11a3fa78e9a">  278</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespace_d_t_p_m__utils.html#a09a93a8e21f05873ab9bf11a3fa78e9a">merge_hardware_counters_single_app</a>():</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;!</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="stringliteral">    Based on the Odroid-XU3 hardware counter profiles, filter and merge the hardware counters for individual applications into a single file.</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">for</span> i, trace_name <span class="keywordflow">in</span> enumerate(common.MERGE_LIST):</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        print(<span class="stringliteral">&quot;Trace name:&quot;</span>, trace_name)</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        trace = pd.read_csv(trace_name).drop([<span class="stringliteral">&#39;Thread Number&#39;</span>, <span class="stringliteral">&#39;Time Stamp (s)&#39;</span>, <span class="stringliteral">&#39;A7_power (W)&#39;</span>, <span class="stringliteral">&#39;A15_power (W)&#39;</span>, <span class="stringliteral">&#39;Memory (W)&#39;</span>, <span class="stringliteral">&#39;GPU (W)&#39;</span>,</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                                              <span class="stringliteral">&#39;Sample Name&#39;</span>, <span class="stringliteral">&#39;Execution Time (s)&#39;</span>,</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                                              <span class="stringliteral">&#39; TEMP_CPU_0 (C)&#39;</span>, <span class="stringliteral">&#39;TEMP_CPU_1 (C)&#39;</span>, <span class="stringliteral">&#39;TEMP_CPU_2 (C)&#39;</span>, <span class="stringliteral">&#39;TEMP_CPU_3 (C)&#39;</span>, <span class="stringliteral">&#39;TEMP_CPU_4 (C)&#39;</span>,</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                                              <span class="stringliteral">&#39;Util_0(%)&#39;</span>, <span class="stringliteral">&#39;Util_1(%)&#39;</span>, <span class="stringliteral">&#39;Util_2(%)&#39;</span>, <span class="stringliteral">&#39;Util_3(%)&#39;</span>,</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                                              <span class="stringliteral">&#39;Util_4(%)&#39;</span>, <span class="stringliteral">&#39;Util_5(%)&#39;</span>, <span class="stringliteral">&#39;Util_6(%)&#39;</span>, <span class="stringliteral">&#39;Util_7(%)&#39;</span>,</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                                              <span class="stringliteral">&#39;CPU_Online_0&#39;</span>, <span class="stringliteral">&#39;CPU_Online_1&#39;</span>, <span class="stringliteral">&#39;CPU_Online_2&#39;</span>, <span class="stringliteral">&#39;CPU_Online_3&#39;</span>,</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                                              <span class="stringliteral">&#39;CPU_Online_4&#39;</span>, <span class="stringliteral">&#39;CPU_Online_5&#39;</span>, <span class="stringliteral">&#39;CPU_Online_6&#39;</span>, <span class="stringliteral">&#39;CPU_Online_7&#39;</span>,</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                                              <span class="stringliteral">&#39;FREQ_CPU_1 (GHz)&#39;</span>, <span class="stringliteral">&#39;FREQ_CPU_2 (GHz)&#39;</span>, <span class="stringliteral">&#39;FREQ_CPU_3 (GHz)&#39;</span>,</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                                              <span class="stringliteral">&#39;FREQ_CPU_5 (GHz)&#39;</span>, <span class="stringliteral">&#39;FREQ_CPU_6 (GHz)&#39;</span>, <span class="stringliteral">&#39;FREQ_CPU_7 (GHz)&#39;</span>], axis=1).astype(float)</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        trace = trace.rename(columns={<span class="stringliteral">&#39;FREQ_CPU_0 (GHz)&#39;</span>: <span class="stringliteral">&#39;FREQ_PE_0 (GHz)&#39;</span>,</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                                      <span class="stringliteral">&#39;FREQ_CPU_4 (GHz)&#39;</span>: <span class="stringliteral">&#39;FREQ_PE_1 (GHz)&#39;</span>})</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="comment"># Get average hardware counters across all iterations</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        trace_avg = trace.groupby([<span class="stringliteral">&#39;Workload Name&#39;</span>, <span class="stringliteral">&#39;N_little&#39;</span>, <span class="stringliteral">&#39;N_big&#39;</span>,</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                   <span class="stringliteral">&#39;FREQ_PE_0 (GHz)&#39;</span>, <span class="stringliteral">&#39;FREQ_PE_1 (GHz)&#39;</span>]).mean()</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        hardware_counters = trace_avg.reset_index(drop=<span class="keyword">False</span>).drop([<span class="stringliteral">&#39;Iteration Num&#39;</span>], axis=1)</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="comment"># Adjust workload name according to the pre-defined order</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        hardware_counters[<span class="stringliteral">&#39;Workload Name&#39;</span>] = i</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keywordflow">if</span> i == 0:</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            hardware_counters.to_csv(common.HARDWARE_COUNTERS_SINGLE_APP, mode=<span class="stringliteral">&#39;w&#39;</span>, index=<span class="keyword">False</span>, header=<span class="keyword">True</span>)</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            hardware_counters.to_csv(common.HARDWARE_COUNTERS_SINGLE_APP, mode=<span class="stringliteral">&#39;a&#39;</span>, index=<span class="keyword">False</span>, header=<span class="keyword">False</span>)</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno"><a class="line" href="namespace_d_t_p_m__utils.html#ac1dcbad85c5db3c717aba9fbb47d9156">  310</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespace_d_t_p_m__utils.html#ac1dcbad85c5db3c717aba9fbb47d9156">multinomial_combinations</a>(n, k):</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;!</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="stringliteral">    Return a list (2d numpy array) of all length k sequences of</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="stringliteral">    non-negative integers n1, ..., nk such that n1 + ... + nk = n.</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="stringliteral">    @param n: Number of jobs per snippet</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="stringliteral">    @param k: Number of applications</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="stringliteral">    @return List containing all combinations of n jobs and k applications that create a snippet</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    bar_placements = itertools.combinations(range(1, n+k), k-1)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    tmp = [(0,) + x + (n+k,) <span class="keywordflow">for</span> x <span class="keywordflow">in</span> bar_placements]</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    sequences =  np.diff(tmp) - 1</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">return</span> list(sequences[::-1])</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno"><a class="line" href="namespace_d_t_p_m__utils.html#ae8e76ba0c3ac61fef520ec1fc6b23d43">  323</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespace_d_t_p_m__utils.html#ae8e76ba0c3ac61fef520ec1fc6b23d43">window_list</a>(seq, n=2):</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;!</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="stringliteral">    Return a sliding window_list (of width n) over data from the iterable, s -&gt; (s0,s1,...s[n-1]), (s1,s2,...,sn), ...</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    it = iter(seq)</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    result = tuple(islice(it, n))</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordflow">if</span> len(result) == n:</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="keywordflow">yield</span> result</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">for</span> elem <span class="keywordflow">in</span> it:</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        result = result[1:] + (elem,)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="keywordflow">yield</span> result</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno"><a class="line" href="namespace_d_t_p_m__utils.html#a99c4874a0cdace15b2da8a09ed5149d4">  335</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespace_d_t_p_m__utils.html#a99c4874a0cdace15b2da8a09ed5149d4">locate_min</a>(a):</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;!</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="stringliteral">    Return a vector with the min elements of a given list</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    smallest = min(a)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">return</span> [index <span class="keywordflow">for</span> index, element <span class="keywordflow">in</span> enumerate(a)</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            <span class="keywordflow">if</span> smallest == element]</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno"><a class="line" href="namespace_d_t_p_m__utils.html#a7419d7582553e73f0709c51afd361270">  343</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespace_d_t_p_m__utils.html#a7419d7582553e73f0709c51afd361270">oracle_test_RT_and_thermal</a>(execution_time, deadline, max_temp):</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;!</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="stringliteral">    Test whether the current sample satifies the RT and temperature constraints</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="stringliteral">    @param execution_time: Execution time of the current snippet</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="stringliteral">    @param deadline: Execution deadline of the snippet</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="stringliteral">    @param max_temp: Temperature limit of the SoC</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="stringliteral">    @return Whether this sample satifies the constraints</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">if</span> ((common.enable_real_time_constraints <span class="keywordflow">and</span> execution_time &lt;= deadline) <span class="keywordflow">or</span> common.enable_real_time_constraints <span class="keywordflow">is</span> <span class="keyword">False</span> <span class="keywordflow">or</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                 common.real_time_aware_oracle <span class="keywordflow">is</span> <span class="keyword">False</span>):</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="keywordflow">if</span> (common.enable_thermal_management <span class="keywordflow">and</span> max_temp &lt; common.DTPM_thermal_limit) <span class="keywordflow">or</span> common.enable_thermal_management <span class="keywordflow">is</span> <span class="keyword">False</span>:</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno"><a class="line" href="namespace_d_t_p_m__utils.html#aee85a0d8ebdec96411b002f24fd7deee">  360</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespace_d_t_p_m__utils.html#aee85a0d8ebdec96411b002f24fd7deee">find_oracle_group</a>(arg_list):</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;!</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="stringliteral">    Return oracle decisions for a given group of snippets</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="stringliteral">    @param arg_list: Job_list and a list of samples that belong to a specific configuration</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="stringliteral">    @return The oracle decision for a given snippet</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    job_list = arg_list[0]</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    group = arg_list[1]</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">if</span> common.enable_real_time_constraints <span class="keywordflow">and</span> common.deadline_dict == {}:</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        common.deadline_dict = <a class="code" href="namespace_d_t_p_m__utils.html#a7932918de66e9976e37fc3adbe5355bb">get_snippet_deadlines</a>()</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    min_EDP = math.inf</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    min_exec_time = math.inf</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    oracle_row = []</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordflow">for</span> index, row <span class="keywordflow">in</span> group.iterrows():</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        execution_time = float(row[<span class="stringliteral">&#39;Execution Time (s)&#39;</span>])</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        energy_consumption = float(row[<span class="stringliteral">&#39;Energy Consumption (J)&#39;</span>])</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        EDP_row = energy_consumption * execution_time</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="keywordflow">if</span> common.enable_real_time_constraints <span class="keywordflow">and</span> job_list <span class="keywordflow">in</span> common.deadline_dict:</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            deadline = common.deadline_dict[job_list]</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            deadline = math.inf</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordflow">if</span> (common.optimization_objective == <span class="stringliteral">&quot;EDP&quot;</span>) <span class="keywordflow">and</span> (EDP_row &lt; min_EDP):</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            <span class="keywordflow">if</span> <a class="code" href="namespace_d_t_p_m__utils.html#a7419d7582553e73f0709c51afd361270">oracle_test_RT_and_thermal</a>(execution_time, deadline, row[<span class="stringliteral">&#39;Max_temp&#39;</span>]):</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                min_EDP = EDP_row</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                oracle_row = row</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="keywordflow">elif</span> (common.optimization_objective == <span class="stringliteral">&quot;performance&quot;</span>) <span class="keywordflow">and</span> (execution_time &lt; min_exec_time):</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            <span class="keywordflow">if</span> <a class="code" href="namespace_d_t_p_m__utils.html#a7419d7582553e73f0709c51afd361270">oracle_test_RT_and_thermal</a>(execution_time, deadline, row[<span class="stringliteral">&#39;Max_temp&#39;</span>]):</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                min_exec_time = execution_time</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                oracle_row = row</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">return</span> job_list, oracle_row</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno"><a class="line" href="namespace_d_t_p_m__utils.html#a869b37f609993178f3feeba27f1a28eb">  394</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespace_d_t_p_m__utils.html#a869b37f609993178f3feeba27f1a28eb">get_oracle_frequencies_and_num_cores</a>():</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;!</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="stringliteral">    Create a dictionary that stores the oracle configuration for for each group &lt;Workload, Snippet ID&gt;</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="stringliteral">    @return Dictionary with oracle configurations</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <a class="code" href="namespace_d_t_p_m__utils.html#aaa6baa9535ed6c6f892e25bcb546486c">load_hardware_counters</a>()</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">if</span> os.path.exists(common.DATASET_FILE_DTPM):</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        dataset = pd.read_csv(common.DATASET_FILE_DTPM)</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        dataset = pd.read_csv(common.DATASET_FILE_DTPM.split(<span class="stringliteral">&#39;.&#39;</span>)[0] + <span class="stringliteral">&quot;_freq_oracle.csv&quot;</span>)</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment"># If the number of cores prediction is disabled, only consider N_big = 4 and N_little = 4 for the oracle generation</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordflow">if</span> <span class="keywordflow">not</span> common.enable_num_cores_prediction:</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        dataset = dataset[(dataset[<span class="stringliteral">&#39;N_big&#39;</span>] == 4) &amp; (dataset[<span class="stringliteral">&#39;N_little&#39;</span>] == 4)]</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    grouped_tid_jid = dataset.groupby([<span class="stringliteral">&#39;Job List&#39;</span>])</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    num_groups = len(grouped_tid_jid)</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    pool = multiprocessing.Pool(min(num_groups, multiprocessing.cpu_count()))</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    config_list = pool.map(find_oracle_group, [[name, group] <span class="keywordflow">for</span> name, group <span class="keywordflow">in</span> grouped_tid_jid])</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    pool.close()</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    grouped_tid_jid = <span class="keywordtype">None</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    config_dict = {}</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">for</span> list <span class="keywordflow">in</span> config_list:</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        sample_ID, oracle_row = list</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        config_dict.update({sample_ID : oracle_row})</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">return</span> config_dict</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno"><a class="line" href="namespace_d_t_p_m__utils.html#a65bf6bc0b22845b0e75422395ce132ac">  424</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespace_d_t_p_m__utils.html#a65bf6bc0b22845b0e75422395ce132ac">add_oracle_to_dataset</a>(oracle_type):</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;!</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="stringliteral">    Read the dataset and add the oracle decision for all samples</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="stringliteral">    @param oracle_type: Oracle type e.g., frequency, number of cores, execution time (regression)</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    print(<span class="stringliteral">&quot;Updating dataset... ({})&quot;</span>.format(oracle_type))</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordflow">if</span> oracle_type == <span class="stringliteral">&#39;Frequency&#39;</span>:</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        oracle_file = common.DATASET_FILE_DTPM.split(<span class="stringliteral">&quot;.&quot;</span>)[0] + <span class="stringliteral">&quot;_freq_oracle.csv&quot;</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">elif</span> oracle_type == <span class="stringliteral">&#39;Num_cores&#39;</span>:</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        oracle_file = common.DATASET_FILE_DTPM.split(<span class="stringliteral">&quot;.&quot;</span>)[0] + <span class="stringliteral">&quot;_num_cores_oracle.csv&quot;</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">elif</span> oracle_type == <span class="stringliteral">&#39;Regression&#39;</span>:</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        oracle_file = common.DATASET_FILE_DTPM.split(<span class="stringliteral">&quot;.&quot;</span>)[0] + <span class="stringliteral">&quot;_regression_oracle.csv&quot;</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        print(<span class="stringliteral">&quot;[E] Error while generating the oracle dataset, type {} not recognized&quot;</span>.format(oracle_type))</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        sys.exit()</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    oracle_dataset = open(oracle_file, <span class="stringliteral">&quot;w&quot;</span>)</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordflow">for</span> i, chunk <span class="keywordflow">in</span> enumerate(pd.read_csv(common.DATASET_FILE_DTPM, chunksize=1000000, iterator=<span class="keyword">True</span>)):</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        print(<span class="stringliteral">&quot;Loading chunk {}...&quot;</span>.format(i))</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="keywordflow">for</span> index, row <span class="keywordflow">in</span> pd.DataFrame(chunk).iterrows():</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            oracle_row = common.oracle_config_dict[row[<span class="stringliteral">&#39;Job List&#39;</span>]]</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            <span class="keywordflow">if</span> oracle_type == <span class="stringliteral">&#39;Frequency&#39;</span>:</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                oracle_freq = []</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                <span class="keywordflow">for</span> PE_ID <span class="keywordflow">in</span> range(len(common.ClusterManager.cluster_list) - 1):</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                    oracle_freq.append(oracle_row[<span class="stringliteral">&#39;FREQ_PE_&#39;</span> + str(PE_ID) + <span class="stringliteral">&#39; (GHz)&#39;</span>])</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                chunk.at[index, <span class="stringliteral">&#39;Oracle_freq&#39;</span>] = str(oracle_freq)</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            <span class="keywordflow">elif</span> oracle_type == <span class="stringliteral">&#39;Num_cores&#39;</span>:</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                oracle_num_cores = []</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                oracle_num_cores.append(<a class="code" href="namespace_d_t_p_m__train__model.html#a85fef18c2b4b364897ad4be9ba9dcc6b">int</a>(oracle_row[<span class="stringliteral">&#39;N_little&#39;</span>]))</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                oracle_num_cores.append(<a class="code" href="namespace_d_t_p_m__train__model.html#a85fef18c2b4b364897ad4be9ba9dcc6b">int</a>(oracle_row[<span class="stringliteral">&#39;N_big&#39;</span>]))</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                chunk.at[index, <span class="stringliteral">&#39;Oracle_num_cores&#39;</span>] = str(oracle_num_cores)</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="keywordflow">if</span> oracle_type == <span class="stringliteral">&#39;Regression&#39;</span>:</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            <span class="comment"># Re-order the exec time column to the last position</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            cols = list(chunk.columns.values)</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            cols.remove(<span class="stringliteral">&#39;Execution Time (s)&#39;</span>)</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            cols.append(<span class="stringliteral">&#39;Execution Time (s)&#39;</span>)</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            chunk = chunk.reindex(columns=cols)</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            chunk = chunk.rename(columns={<span class="stringliteral">&#39;Execution Time (s)&#39;</span>: <span class="stringliteral">&#39;Oracle_regression&#39;</span>})</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="keywordflow">if</span> i == 0:</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            chunk.to_csv(oracle_dataset, mode=<span class="stringliteral">&#39;a&#39;</span>, sep=<span class="stringliteral">&#39;,&#39;</span>, index=<span class="keyword">False</span>, header=<span class="keyword">True</span>)</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            chunk.to_csv(oracle_dataset, mode=<span class="stringliteral">&#39;a&#39;</span>, sep=<span class="stringliteral">&#39;,&#39;</span>, index=<span class="keyword">False</span>, header=<span class="keyword">False</span>)</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    oracle_dataset.close()</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno"><a class="line" href="namespace_d_t_p_m__utils.html#adde6dd5203b0df388d4dd9c86df8b3fa">  467</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespace_d_t_p_m__utils.html#adde6dd5203b0df388d4dd9c86df8b3fa">create_reduced_dataset</a>(oracle_type):</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;!</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="stringliteral">    Create dataset for leave-one-out experiments, completely remove one application from the dataset, configured in config_file.ini.</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="stringliteral">    @param oracle_type: Oracle type e.g., frequency, number of cores, execution time (regression)</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordflow">if</span> oracle_type == <span class="stringliteral">&#39;Frequency&#39;</span>:</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        oracle_file = common.DATASET_FILE_DTPM.split(<span class="stringliteral">&quot;.&quot;</span>)[0] + <span class="stringliteral">&quot;_freq_oracle.csv&quot;</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">elif</span> oracle_type == <span class="stringliteral">&#39;Num_cores&#39;</span>:</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        oracle_file = common.DATASET_FILE_DTPM.split(<span class="stringliteral">&quot;.&quot;</span>)[0] + <span class="stringliteral">&quot;_num_cores_oracle.csv&quot;</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">elif</span> oracle_type == <span class="stringliteral">&#39;Regression&#39;</span>:</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        oracle_file = common.DATASET_FILE_DTPM.split(<span class="stringliteral">&quot;.&quot;</span>)[0] + <span class="stringliteral">&quot;_regression_oracle.csv&quot;</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        print(<span class="stringliteral">&quot;[E] Error while generating the oracle dataset, type {} not recognized&quot;</span>.format(oracle_type))</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        sys.exit()</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="comment"># Reduce dataset</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    dataset = pd.read_csv(oracle_file)</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    dataset_size = dataset.shape[0]</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    print(<span class="stringliteral">&quot;Complete dataset:&quot;</span>, dataset_size)</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    num_jobs = len(dataset[<span class="stringliteral">&#39;Job List&#39;</span>][0].split(<span class="stringliteral">&#39;,&#39;</span>))</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    search_string = <span class="stringliteral">&#39;[[]&#39;</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(num_jobs):</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="keywordflow">if</span> i == 0:</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            <span class="keywordflow">if</span> i == common.remove_app_ID:</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                search_string += <span class="stringliteral">&#39;0&#39;</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                search_string += <span class="stringliteral">&#39;.*&#39;</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            <span class="keywordflow">if</span> i == common.remove_app_ID:</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                search_string += <span class="stringliteral">&#39;, 0&#39;</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                search_string += <span class="stringliteral">&#39;, .*&#39;</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    search_string += <span class="stringliteral">&#39;[]]&#39;</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    reduced_dataset = dataset[dataset[<span class="stringliteral">&#39;Job List&#39;</span>].str.contains(search_string, regex=<span class="keyword">True</span>)]</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    reduced_dataset_size = reduced_dataset.shape[0]</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    print(<span class="stringliteral">&quot;Reduced dataset:&quot;</span>, reduced_dataset_size)</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    print(<span class="stringliteral">&quot;Fraction: {:2f}&quot;</span>.format(reduced_dataset_size/dataset_size))</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    reduced_dataset.to_csv(oracle_file.split(<span class="stringliteral">&#39;.&#39;</span>)[0] + <span class="stringliteral">&quot;_reduced.csv&quot;</span>, index=<span class="keyword">False</span>)</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno"><a class="line" href="namespace_d_t_p_m__utils.html#ad8283097fe03394692d2c86c14782228">  508</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespace_d_t_p_m__utils.html#ad8283097fe03394692d2c86c14782228">update_oracle_dataset</a>(dataset_name, dataset_type):</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;!</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="stringliteral">    Update datasets with current oracle decisions after the DAgger iteration finishes.</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="stringliteral">    @param dataset_name: Name of the dataset</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="stringliteral">    @param dataset_type: Complete or reduced dataset</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordflow">if</span> dataset_type == <span class="stringliteral">&#39;complete&#39;</span>:</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        dataset_file = common.DATASET_FILE_DTPM.split(<span class="stringliteral">&#39;.&#39;</span>)[0] + <span class="stringliteral">&quot;_&quot;</span> + dataset_name + <span class="stringliteral">&quot;_oracle.csv&quot;</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        dataset_file = common.DATASET_FILE_DTPM.split(<span class="stringliteral">&#39;.&#39;</span>)[0] + <span class="stringliteral">&quot;_&quot;</span> + dataset_name + <span class="stringliteral">&quot;_oracle_reduced.csv&quot;</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keyword">with</span> open(dataset_file, <span class="stringliteral">&quot;r&quot;</span>) <span class="keyword">as</span> f:</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        dataset = list(csv.reader(f))</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keyword">with</span> open(dataset_file, <span class="stringliteral">&quot;w&quot;</span>) <span class="keyword">as</span> f:</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        writer = csv.writer(f)</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="keywordflow">for</span> i, row <span class="keywordflow">in</span> enumerate(dataset):</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            <span class="keywordflow">if</span> i == 0:</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                writer.writerow(row)</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                oracle_row = common.oracle_config_dict[row[0]]</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                <span class="keywordflow">if</span> dataset_name == <span class="stringliteral">&#39;freq&#39;</span>:</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                    oracle_freq = []</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                    <span class="keywordflow">for</span> PE_ID <span class="keywordflow">in</span> range(len(common.ClusterManager.cluster_list) - 1):</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                        oracle_freq.append(oracle_row[<span class="stringliteral">&#39;FREQ_PE_&#39;</span> + str(PE_ID) + <span class="stringliteral">&#39; (GHz)&#39;</span>])</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                    row[-1] = str(oracle_freq)</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                    writer.writerow(row)</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                <span class="keywordflow">elif</span> dataset_name == <span class="stringliteral">&#39;num_cores&#39;</span>:</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                    oracle_num_cores = []</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                    oracle_num_cores.append(<a class="code" href="namespace_d_t_p_m__train__model.html#a85fef18c2b4b364897ad4be9ba9dcc6b">int</a>(oracle_row[<span class="stringliteral">&#39;N_little&#39;</span>]))</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                    oracle_num_cores.append(<a class="code" href="namespace_d_t_p_m__train__model.html#a85fef18c2b4b364897ad4be9ba9dcc6b">int</a>(oracle_row[<span class="stringliteral">&#39;N_big&#39;</span>]))</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                    row[-1] = str(oracle_num_cores)</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                    writer.writerow(row)</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                <span class="keywordflow">elif</span> dataset_name == <span class="stringliteral">&#39;regression&#39;</span>:</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                    row[-1] = str(oracle_row[<span class="stringliteral">&#39;Execution Time (s)&#39;</span>])</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                    writer.writerow(row)</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160; </div>
<div class="line"><a name="l00543"></a><span class="lineno"><a class="line" href="namespace_d_t_p_m__utils.html#a0037071bb37f4eb231443e6ceaba9012">  543</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespace_d_t_p_m__utils.html#a0037071bb37f4eb231443e6ceaba9012">sed_inplace</a>(filename, pattern, repl):</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;!</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="stringliteral">    Perform the pure-Python equivalent of in-place `sed` substitution: e.g.,</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="stringliteral">    `sed -i -e &#39;s/&#39;${pattern}&#39;/&#39;${repl}&#39; &quot;${filename}&quot;`.</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    pattern_compiled = re.compile(pattern)</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="keyword">with</span> tempfile.NamedTemporaryFile(mode=<span class="stringliteral">&#39;w&#39;</span>, delete=<span class="keyword">False</span>) <span class="keyword">as</span> tmp_file:</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="keyword">with</span> open(filename) <span class="keyword">as</span> src_file:</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            <span class="keywordflow">for</span> line <span class="keywordflow">in</span> src_file:</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                tmp_file.write(pattern_compiled.sub(repl, line))</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    shutil.copystat(filename, tmp_file.name)</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    shutil.move(tmp_file.name, filename)</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; </div>
<div class="line"><a name="l00556"></a><span class="lineno"><a class="line" href="namespace_d_t_p_m__utils.html#a7a7c5a77471e4cf2477cc0a8df97b8d0">  556</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespace_d_t_p_m__utils.html#a7a7c5a77471e4cf2477cc0a8df97b8d0">update_temperature_dataset</a>(dataset_name, system_state, oracle, dataset_type, PEs):</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;!</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="stringliteral">    Update datasets with current temperature profiles</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="stringliteral">    @param dataset_name: Name of the dataset</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="stringliteral">    @param system_state: Current system state</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="stringliteral">    @param oracle: Oracle decision</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="stringliteral">    @param dataset_type: Complete or reduced dataset</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="stringliteral">    @param PEs: List of PEs</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keywordflow">if</span> dataset_type == <span class="stringliteral">&#39;complete&#39;</span>:</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        dataset_file = common.DATASET_FILE_DTPM.split(<span class="stringliteral">&#39;.&#39;</span>)[0] + <span class="stringliteral">&quot;_&quot;</span> + dataset_name + <span class="stringliteral">&quot;_oracle.csv&quot;</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        dataset_file = common.DATASET_FILE_DTPM.split(<span class="stringliteral">&#39;.&#39;</span>)[0] + <span class="stringliteral">&quot;_&quot;</span> + dataset_name + <span class="stringliteral">&quot;_oracle_reduced.csv&quot;</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="keywordflow">if</span> common.first_DAgger_iteration:</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="comment"># Predict the temperature for all snippet configurations in the first DAgger iteration</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        dataset = pd.read_csv(dataset_file)</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="keywordflow">for</span> idx, row <span class="keywordflow">in</span> dataset.iterrows():</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            <span class="keywordflow">if</span> str(row[<span class="stringliteral">&#39;Job List&#39;</span>]) == str(system_state[<span class="stringliteral">&#39;Job List&#39;</span>]):</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                power_list = <a class="code" href="namespace_d_t_p_m__utils.html#a4e13030d9ca8f69b59ccaa9347f29a5e">get_power_list_prediction</a>(row, PEs, common.snippet_initial_temp)</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                predicted_temperature = <a class="code" href="namespace_d_t_p_m__power__models.html#abddd7e05302d27a6bee489f31db0c9a9">DTPM_power_models.predict_temperature_N_steps</a>(power_list)</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                predicted_temperature_value = max(predicted_temperature)</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                dataset.at[idx, <span class="stringliteral">&#39;Max_temp&#39;</span>] = predicted_temperature_value</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                dataset.at[idx, <span class="stringliteral">&#39;Min_temp&#39;</span>] = predicted_temperature_value</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                dataset.at[idx, <span class="stringliteral">&#39;Avg_temp&#39;</span>] = predicted_temperature_value</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        dataset.to_csv(dataset_file, mode=<span class="stringliteral">&#39;w&#39;</span>, index=<span class="keyword">False</span>, header=<span class="keyword">True</span>)</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordflow">elif</span> platform == <span class="stringliteral">&quot;linux&quot;</span>:</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        search_string = <span class="stringliteral">&quot;\&quot;\\&quot;</span> + str(system_state[<span class="stringliteral">&#39;Job List&#39;</span>]).split(<span class="stringliteral">&#39;]&#39;</span>)[0] + <span class="stringliteral">&quot;\\]\&quot;,&quot;</span> + str(system_state[<span class="stringliteral">&#39;N_little&#39;</span>]) + <span class="stringliteral">&quot;,&quot;</span> + str(system_state[<span class="stringliteral">&#39;N_big&#39;</span>]) + <span class="stringliteral">&quot;,&quot;</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <span class="keywordflow">for</span> cluster_ID <span class="keywordflow">in</span> range(len(common.ClusterManager.cluster_list) - 1):</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            search_string += str(system_state[<span class="stringliteral">&#39;FREQ_PE_&#39;</span> + str(cluster_ID) + <span class="stringliteral">&#39; (GHz)&#39;</span>]) + <span class="stringliteral">&quot;,&quot;</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        <span class="keywordflow">if</span> len(common.snippet_temp_list) &gt; 0:</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            system_state[<span class="stringliteral">&#39;Max_temp&#39;</span>] = max(common.snippet_temp_list)</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            system_state[<span class="stringliteral">&#39;Min_temp&#39;</span>] = min(common.snippet_temp_list)</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            system_state[<span class="stringliteral">&#39;Avg_temp&#39;</span>] = mean(common.snippet_temp_list)</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            system_state[<span class="stringliteral">&#39;Throttling State&#39;</span>] = common.snippet_throttle</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        system_state[<span class="stringliteral">&#39;Oracle_&#39;</span> + str(dataset_name)] = str(oracle)</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        replace_line = <span class="stringliteral">&quot;&quot;</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <span class="keywordflow">for</span> i, item <span class="keywordflow">in</span> enumerate(system_state):</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            <span class="keywordflow">if</span> i == 0:  <span class="comment"># First item is a list &quot;Job list&quot;</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                replace_line += <span class="stringliteral">&quot;\&quot;\\&quot;</span> + str(item).split(<span class="stringliteral">&#39;]&#39;</span>)[0] + <span class="stringliteral">&quot;\\]\&quot;,&quot;</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            <span class="keywordflow">elif</span> i == len(system_state) - 1 <span class="keywordflow">and</span> (dataset_name == <span class="stringliteral">&#39;freq&#39;</span> <span class="keywordflow">or</span> dataset_name == <span class="stringliteral">&#39;num_cores&#39;</span>):  <span class="comment"># Last item is a list for freq and num_cores datasets</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                replace_line += <span class="stringliteral">&quot;\&quot;\\&quot;</span> + str(item).split(<span class="stringliteral">&#39;]&#39;</span>)[0] + <span class="stringliteral">&quot;\\]\&quot;&quot;</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                replace_line += str(item)</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                <span class="keywordflow">if</span> i != len(system_state) - 1:</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                    replace_line += <span class="stringliteral">&quot;,&quot;</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        replace_line_command = <span class="stringliteral">&quot;sed -i \&#39;/&quot;</span> + search_string + <span class="stringliteral">&quot;/c\\&quot;</span> + replace_line + <span class="stringliteral">&quot;\&#39; &quot;</span> + dataset_file</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        os.system(replace_line_command)</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        search_string = <span class="stringliteral">&quot;\&quot;\\&quot;</span> + str(system_state[<span class="stringliteral">&#39;Job List&#39;</span>]).split(<span class="stringliteral">&#39;]&#39;</span>)[0] + <span class="stringliteral">&quot;\\]\&quot;,&quot;</span> + str(system_state[<span class="stringliteral">&#39;N_little&#39;</span>]) + <span class="stringliteral">&quot;,&quot;</span> + str(system_state[<span class="stringliteral">&#39;N_big&#39;</span>]) + <span class="stringliteral">&quot;,&quot;</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="keywordflow">for</span> cluster_ID <span class="keywordflow">in</span> range(len(common.ClusterManager.cluster_list) - 1):</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            search_string += str(system_state[<span class="stringliteral">&#39;FREQ_PE_&#39;</span> + str(cluster_ID) + <span class="stringliteral">&#39; (GHz)&#39;</span>]) + <span class="stringliteral">&quot;,&quot;</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        search_string +=<span class="stringliteral">&quot;.*&quot;</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160; </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <span class="keywordflow">if</span> len(common.snippet_temp_list) &gt; 0:</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            system_state[<span class="stringliteral">&#39;Max_temp&#39;</span>] = max(common.snippet_temp_list)</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            system_state[<span class="stringliteral">&#39;Min_temp&#39;</span>] = min(common.snippet_temp_list)</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            system_state[<span class="stringliteral">&#39;Avg_temp&#39;</span>] = mean(common.snippet_temp_list)</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            system_state[<span class="stringliteral">&#39;Throttling State&#39;</span>] = common.snippet_throttle</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        system_state[<span class="stringliteral">&#39;Oracle_&#39;</span> + str(dataset_name)] = str(oracle)</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160; </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        replace_line = <span class="stringliteral">&quot;&quot;</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <span class="keywordflow">for</span> i, item <span class="keywordflow">in</span> enumerate(system_state):</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            <span class="keywordflow">if</span> i == 0:  <span class="comment"># First item is a list &quot;Job list&quot;</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                replace_line += <span class="stringliteral">&quot;\&quot;&quot;</span> + str(item).split(<span class="stringliteral">&#39;]&#39;</span>)[0] + <span class="stringliteral">&quot;]\&quot;,&quot;</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            <span class="keywordflow">elif</span> i == len(system_state) - 1 <span class="keywordflow">and</span> (dataset_name == <span class="stringliteral">&#39;freq&#39;</span> <span class="keywordflow">or</span> dataset_name == <span class="stringliteral">&#39;num_cores&#39;</span>):  <span class="comment"># Last item is a list for freq and num_cores datasets</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                replace_line += <span class="stringliteral">&quot;\&quot;&quot;</span> + str(item).split(<span class="stringliteral">&#39;]&#39;</span>)[0] + <span class="stringliteral">&quot;]\&quot;&quot;</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                replace_line += str(item)</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                <span class="keywordflow">if</span> i != len(system_state) - 1:</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                    replace_line += <span class="stringliteral">&quot;,&quot;</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <a class="code" href="namespace_d_t_p_m__utils.html#a0037071bb37f4eb231443e6ceaba9012">sed_inplace</a>(dataset_file, search_string, replace_line)</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160; </div>
<div class="line"><a name="l00631"></a><span class="lineno"><a class="line" href="namespace_d_t_p_m__utils.html#a4e13030d9ca8f69b59ccaa9347f29a5e">  631</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespace_d_t_p_m__utils.html#a4e13030d9ca8f69b59ccaa9347f29a5e">get_power_list_prediction</a>(row, PEs, input_temperature):</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;!</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="stringliteral">    Predict the power for all clusters based on the inputs</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="stringliteral">    @param row: Dataset row (sample)</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="stringliteral">    @param PEs: List of PEs</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="stringliteral">    @param input_temperature: Baseline temperature</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="stringliteral">    @return Power consumption prediction for all clusters</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    power_list = []</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="keywordflow">for</span> cluster <span class="keywordflow">in</span> common.ClusterManager.cluster_list:</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        <span class="keywordflow">if</span> cluster.type != <span class="stringliteral">&#39;MEM&#39;</span>:</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            N_cores = 1</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            <span class="keywordflow">if</span> cluster.type == <span class="stringliteral">&#39;LTL&#39;</span>:</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                N_cores = <a class="code" href="namespace_d_t_p_m__train__model.html#a85fef18c2b4b364897ad4be9ba9dcc6b">int</a>(row[<span class="stringliteral">&#39;N_little&#39;</span>])</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            <span class="keywordflow">elif</span> cluster.type == <span class="stringliteral">&#39;BIG&#39;</span>:</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                N_cores = <a class="code" href="namespace_d_t_p_m__train__model.html#a85fef18c2b4b364897ad4be9ba9dcc6b">int</a>(row[<span class="stringliteral">&#39;N_big&#39;</span>])</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            num_tasks = <a class="code" href="namespace_d_t_p_m__train__model.html#a85fef18c2b4b364897ad4be9ba9dcc6b">int</a>(mean(cluster.snippet_num_tasks_list))</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            <span class="comment"># num_tasks = int(max(cluster.snippet_num_tasks_list))</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            num_tasks = max(min(num_tasks, N_cores), 1)</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            frequency = <a class="code" href="namespace_d_t_p_m__train__model.html#a85fef18c2b4b364897ad4be9ba9dcc6b">int</a>(float(row[<span class="stringliteral">&#39;FREQ_PE_&#39;</span> + str(cluster.ID) + <span class="stringliteral">&#39; (GHz)&#39;</span>]) * 1000)</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            voltage = <a class="code" href="namespace_d_t_p_m__power__models.html#abd99e7ecc4a5cea6d0c1184e512b7424">DTPM_power_models.get_voltage_constant_mode</a>(cluster.OPP, frequency)</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            static_power = <a class="code" href="namespace_d_t_p_m__power__models.html#af8b8111dffef911ea6338fe31fb371c8">DTPM_power_models.compute_static_power_dissipation</a>(cluster.ID, input_temperature=input_temperature,</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                                                                              input_voltage=voltage)</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            max_power_consumption, freq_threshold = <a class="code" href="namespace_d_t_p_m__power__models.html#aa395bf114a31df88ad5f3e7513b8a08e">DTPM_power_models.get_max_power_consumption</a>(cluster, PEs, N_tasks=num_tasks,</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                                                                                                N_cores=N_cores)</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            max_power_core = max_power_consumption / num_tasks</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            Cdyn_alpha = <a class="code" href="namespace_d_t_p_m__power__models.html#a33aef80593b650e23f5b1f79dd878e4a">DTPM_power_models.compute_Cdyn_and_alpha</a>(<span class="keywordtype">None</span>, max_power_core, freq_threshold, OPP=cluster.OPP)</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            dynamic_power = <a class="code" href="namespace_d_t_p_m__power__models.html#a745d2c5771fd1b2bda1ef599bdc2b362">DTPM_power_models.compute_dynamic_power_dissipation</a>(frequency, voltage, Cdyn_alpha)</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160; </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            total_power = static_power * N_cores + dynamic_power * min(num_tasks, N_cores)</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            power_list.append(total_power)</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="keywordflow">return</span> power_list</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; </div>
<div class="line"><a name="l00667"></a><span class="lineno"><a class="line" href="namespace_d_t_p_m__utils.html#a7932918de66e9976e37fc3adbe5355bb">  667</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespace_d_t_p_m__utils.html#a7932918de66e9976e37fc3adbe5355bb">get_snippet_deadlines</a>():</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;!</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="stringliteral">    Get the deadlines for all snippets</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="stringliteral">    @return Dictionary with the snippets&#39; deadlines</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    deadlines = pd.read_csv(common.DEADLINE_FILE)</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    deadline_dict = {}</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordflow">for</span> index, row <span class="keywordflow">in</span> deadlines.iterrows():</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        sample_ID   = row[<span class="stringliteral">&#39;Job List&#39;</span>]</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        deadline    = row[<span class="stringliteral">&#39;Deadline&#39;</span>]</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        deadline_dict.update({sample_ID: deadline})</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keywordflow">return</span> deadline_dict</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160; </div>
<div class="line"><a name="l00680"></a><span class="lineno"><a class="line" href="namespace_d_t_p_m__utils.html#aaa6baa9535ed6c6f892e25bcb546486c">  680</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespace_d_t_p_m__utils.html#aaa6baa9535ed6c6f892e25bcb546486c">load_hardware_counters</a>():</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;!</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="stringliteral">    Update the global hardware counter variable with the trace for the hardware counters, normalizing the counters w.r.t. the number of instructions.</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordflow">if</span> os.path.exists(common.HARDWARE_COUNTERS_TRACE):</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        common.hardware_counters = pd.read_csv(common.HARDWARE_COUNTERS_TRACE)</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="comment"># Normalize hardware counters w.r.t. the number of instructions</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        common.hardware_counters[<span class="stringliteral">&#39;CPU Cycles&#39;</span>] = common.hardware_counters[<span class="stringliteral">&#39;CPU Cycles&#39;</span>] / common.hardware_counters[<span class="stringliteral">&#39;Instructions&#39;</span>]</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        common.hardware_counters[<span class="stringliteral">&#39;Branch Miss Prediction&#39;</span>] = common.hardware_counters[<span class="stringliteral">&#39;Branch Miss Prediction&#39;</span>] / common.hardware_counters[<span class="stringliteral">&#39;Instructions&#39;</span>]</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        common.hardware_counters[<span class="stringliteral">&#39;Level 2 cache misses&#39;</span>] = common.hardware_counters[<span class="stringliteral">&#39;Level 2 cache misses&#39;</span>] / common.hardware_counters[<span class="stringliteral">&#39;Instructions&#39;</span>]</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        common.hardware_counters[<span class="stringliteral">&#39;Data Memory Access&#39;</span>] = common.hardware_counters[<span class="stringliteral">&#39;Data Memory Access&#39;</span>] / common.hardware_counters[<span class="stringliteral">&#39;Instructions&#39;</span>]</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        common.hardware_counters[<span class="stringliteral">&#39;Non-cache External Mem. Req.&#39;</span>] = common.hardware_counters[<span class="stringliteral">&#39;Non-cache External Mem. Req.&#39;</span>] / common.hardware_counters[<span class="stringliteral">&#39;Instructions&#39;</span>]</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160; </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        common.hardware_counters = common.hardware_counters.drop([<span class="stringliteral">&#39;Instructions&#39;</span>], axis=1)</div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="anamespace_d_t_p_m__utils_html_a7a7c5a77471e4cf2477cc0a8df97b8d0"><div class="ttname"><a href="namespace_d_t_p_m__utils.html#a7a7c5a77471e4cf2477cc0a8df97b8d0">DTPM_utils.update_temperature_dataset</a></div><div class="ttdeci">def update_temperature_dataset(dataset_name, system_state, oracle, dataset_type, PEs)</div><div class="ttdoc">Update datasets with current temperature profiles.</div><div class="ttdef"><b>Definition:</b> <a href="_d_t_p_m__utils_8py_source.html#l00556">DTPM_utils.py:556</a></div></div>
<div class="ttc" id="anamespace_d_t_p_m__utils_html_a09a93a8e21f05873ab9bf11a3fa78e9a"><div class="ttname"><a href="namespace_d_t_p_m__utils.html#a09a93a8e21f05873ab9bf11a3fa78e9a">DTPM_utils.merge_hardware_counters_single_app</a></div><div class="ttdeci">def merge_hardware_counters_single_app()</div><div class="ttdoc">Based on the Odroid-XU3 hardware counter profiles, filter and merge the hardware counters for individ...</div><div class="ttdef"><b>Definition:</b> <a href="_d_t_p_m__utils_8py_source.html#l00278">DTPM_utils.py:278</a></div></div>
<div class="ttc" id="anamespace_d_t_p_m__policies_html_af07d973088cfe7873324ca30a30f52b2"><div class="ttname"><a href="namespace_d_t_p_m__policies.html#af07d973088cfe7873324ca30a30f52b2">DTPM_policies.aggregate_data</a></div><div class="ttdeci">def aggregate_data(dataset_name, system_state, oracle)</div><div class="ttdoc">DAgger algorithm - used by the IL-based policies.</div><div class="ttdef"><b>Definition:</b> <a href="_d_t_p_m__policies_8py_source.html#l00561">DTPM_policies.py:561</a></div></div>
<div class="ttc" id="anamespace_d_t_p_m__power__models_html_a33aef80593b650e23f5b1f79dd878e4a"><div class="ttname"><a href="namespace_d_t_p_m__power__models.html#a33aef80593b650e23f5b1f79dd878e4a">DTPM_power_models.compute_Cdyn_and_alpha</a></div><div class="ttdeci">def compute_Cdyn_and_alpha(resource, max_power_consumption, freq_threshold, OPP=None)</div><div class="ttdoc">Based on the maximum frequency, voltage, and measured power dissipation, compute the capacitance C ti...</div><div class="ttdef"><b>Definition:</b> <a href="_d_t_p_m__power__models_8py_source.html#l00073">DTPM_power_models.py:73</a></div></div>
<div class="ttc" id="anamespace_d_t_p_m__power__models_html_abd99e7ecc4a5cea6d0c1184e512b7424"><div class="ttname"><a href="namespace_d_t_p_m__power__models.html#abd99e7ecc4a5cea6d0c1184e512b7424">DTPM_power_models.get_voltage_constant_mode</a></div><div class="ttdeci">def get_voltage_constant_mode(OPP_list, constantFrequency)</div><div class="ttdoc">Get the voltage of the OPP that satisfies the defined constant frequency.</div><div class="ttdef"><b>Definition:</b> <a href="_d_t_p_m__power__models_8py_source.html#l00328">DTPM_power_models.py:328</a></div></div>
<div class="ttc" id="anamespace_d_t_p_m__power__models_html_abddd7e05302d27a6bee489f31db0c9a9"><div class="ttname"><a href="namespace_d_t_p_m__power__models.html#abddd7e05302d27a6bee489f31db0c9a9">DTPM_power_models.predict_temperature_N_steps</a></div><div class="ttdeci">def predict_temperature_N_steps(power_list_clusters)</div><div class="ttdoc">Predict the temperature N_steps ahead.</div><div class="ttdef"><b>Definition:</b> <a href="_d_t_p_m__power__models_8py_source.html#l00244">DTPM_power_models.py:244</a></div></div>
<div class="ttc" id="anamespace_d_t_p_m__utils_html_a859d1e4c979be2758bbf67f936961ea0"><div class="ttname"><a href="namespace_d_t_p_m__utils.html#a859d1e4c979be2758bbf67f936961ea0">DTPM_utils.merge_hardware_counters_multiple_applications</a></div><div class="ttdeci">def merge_hardware_counters_multiple_applications(DVFS_config_list_prod, N_little_list, N_big_list, job_list)</div><div class="ttdoc">Merge the hardware counters from multiple applications to create the snippet profile.</div><div class="ttdef"><b>Definition:</b> <a href="_d_t_p_m__utils_8py_source.html#l00086">DTPM_utils.py:86</a></div></div>
<div class="ttc" id="anamespace_d_t_p_m__utils_html_a7419d7582553e73f0709c51afd361270"><div class="ttname"><a href="namespace_d_t_p_m__utils.html#a7419d7582553e73f0709c51afd361270">DTPM_utils.oracle_test_RT_and_thermal</a></div><div class="ttdeci">def oracle_test_RT_and_thermal(execution_time, deadline, max_temp)</div><div class="ttdoc">Test whether the current sample satifies the RT and temperature constraints.</div><div class="ttdef"><b>Definition:</b> <a href="_d_t_p_m__utils_8py_source.html#l00343">DTPM_utils.py:343</a></div></div>
<div class="ttc" id="anamespace_d_t_p_m__utils_html_ae8e76ba0c3ac61fef520ec1fc6b23d43"><div class="ttname"><a href="namespace_d_t_p_m__utils.html#ae8e76ba0c3ac61fef520ec1fc6b23d43">DTPM_utils.window_list</a></div><div class="ttdeci">def window_list(seq, n=2)</div><div class="ttdoc">Return a sliding window_list (of width n) over data from the iterable, s -&gt; (s0,s1,...</div><div class="ttdef"><b>Definition:</b> <a href="_d_t_p_m__utils_8py_source.html#l00323">DTPM_utils.py:323</a></div></div>
<div class="ttc" id="anamespace_d_t_p_m__utils_html_a5d555ff323892aaf0f663ad6958026b5"><div class="ttname"><a href="namespace_d_t_p_m__utils.html#a5d555ff323892aaf0f663ad6958026b5">DTPM_utils.create_config_list_job_list</a></div><div class="ttdeci">def create_config_list_job_list(params)</div><div class="ttdoc">Read the hardware counter profiles and compute the snippet hardware counters.</div><div class="ttdef"><b>Definition:</b> <a href="_d_t_p_m__utils_8py_source.html#l00235">DTPM_utils.py:235</a></div></div>
<div class="ttc" id="anamespace_d_t_p_m__utils_html_ac1dcbad85c5db3c717aba9fbb47d9156"><div class="ttname"><a href="namespace_d_t_p_m__utils.html#ac1dcbad85c5db3c717aba9fbb47d9156">DTPM_utils.multinomial_combinations</a></div><div class="ttdeci">def multinomial_combinations(n, k)</div><div class="ttdoc">Return a list (2d numpy array) of all length k sequences of non-negative integers n1,...</div><div class="ttdef"><b>Definition:</b> <a href="_d_t_p_m__utils_8py_source.html#l00310">DTPM_utils.py:310</a></div></div>
<div class="ttc" id="anamespace_d_t_p_m__power__models_html_af8b8111dffef911ea6338fe31fb371c8"><div class="ttname"><a href="namespace_d_t_p_m__power__models.html#af8b8111dffef911ea6338fe31fb371c8">DTPM_power_models.compute_static_power_dissipation</a></div><div class="ttdeci">def compute_static_power_dissipation(cluster_ID, input_temperature=None, input_voltage=None)</div><div class="ttdoc">Compute the static power dissipation of the PE.</div><div class="ttdef"><b>Definition:</b> <a href="_d_t_p_m__power__models_8py_source.html#l00099">DTPM_power_models.py:99</a></div></div>
<div class="ttc" id="anamespace_d_a_s_h___sim__v0_html_a635d4b6a4a16ab508897a2089ca4fa05"><div class="ttname"><a href="namespace_d_a_s_h___sim__v0.html#a635d4b6a4a16ab508897a2089ca4fa05">DASH_Sim_v0.run_simulator</a></div><div class="ttdeci">def run_simulator(scale_values=common.scale_values_list)</div><div class="ttdoc">Parse the job and SoC configurations and execute the simulation environment with the parameters from ...</div><div class="ttdef"><b>Definition:</b> <a href="_d_a_s_h___sim__v0_8py_source.html#l00030">DASH_Sim_v0.py:30</a></div></div>
<div class="ttc" id="anamespace_d_t_p_m__utils_html_a767b2af47d4348383131e98dd6726ea0"><div class="ttname"><a href="namespace_d_t_p_m__utils.html#a767b2af47d4348383131e98dd6726ea0">DTPM_utils.create_dataset_IL_DTPM</a></div><div class="ttdeci">def create_dataset_IL_DTPM(timestamp, PEs)</div><div class="ttdoc">Create the dataset used for the IL DTPM policies.</div><div class="ttdef"><b>Definition:</b> <a href="_d_t_p_m__utils_8py_source.html#l00127">DTPM_utils.py:127</a></div></div>
<div class="ttc" id="anamespace_d_t_p_m__utils_html_a4e13030d9ca8f69b59ccaa9347f29a5e"><div class="ttname"><a href="namespace_d_t_p_m__utils.html#a4e13030d9ca8f69b59ccaa9347f29a5e">DTPM_utils.get_power_list_prediction</a></div><div class="ttdeci">def get_power_list_prediction(row, PEs, input_temperature)</div><div class="ttdoc">Predict the power for all clusters based on the inputs.</div><div class="ttdef"><b>Definition:</b> <a href="_d_t_p_m__utils_8py_source.html#l00631">DTPM_utils.py:631</a></div></div>
<div class="ttc" id="anamespace_d_t_p_m__power__models_html_aa395bf114a31df88ad5f3e7513b8a08e"><div class="ttname"><a href="namespace_d_t_p_m__power__models.html#aa395bf114a31df88ad5f3e7513b8a08e">DTPM_power_models.get_max_power_consumption</a></div><div class="ttdeci">def get_max_power_consumption(cluster, PEs, N_tasks=None, N_cores=None)</div><div class="ttdoc">Get the power consumption of the current PE.</div><div class="ttdef"><b>Definition:</b> <a href="_d_t_p_m__power__models_8py_source.html#l00169">DTPM_power_models.py:169</a></div></div>
<div class="ttc" id="anamespace_d_t_p_m__utils_html_a697a0f6bcf116bd0335f8bb2fc10c925"><div class="ttname"><a href="namespace_d_t_p_m__utils.html#a697a0f6bcf116bd0335f8bb2fc10c925">DTPM_utils.run_sim_initial_dataset</a></div><div class="ttdeci">def run_sim_initial_dataset(sim_params)</div><div class="ttdoc">Call the simulator with specific parameters in order to generate the dataset that will be used for th...</div><div class="ttdef"><b>Definition:</b> <a href="_d_t_p_m__utils_8py_source.html#l00026">DTPM_utils.py:26</a></div></div>
<div class="ttc" id="anamespace_d_t_p_m__utils_html_a99c4874a0cdace15b2da8a09ed5149d4"><div class="ttname"><a href="namespace_d_t_p_m__utils.html#a99c4874a0cdace15b2da8a09ed5149d4">DTPM_utils.locate_min</a></div><div class="ttdeci">def locate_min(a)</div><div class="ttdoc">Return a vector with the min elements of a given list.</div><div class="ttdef"><b>Definition:</b> <a href="_d_t_p_m__utils_8py_source.html#l00335">DTPM_utils.py:335</a></div></div>
<div class="ttc" id="anamespace_d_t_p_m__train__model_html_a85fef18c2b4b364897ad4be9ba9dcc6b"><div class="ttname"><a href="namespace_d_t_p_m__train__model.html#a85fef18c2b4b364897ad4be9ba9dcc6b">DTPM_train_model.int</a></div><div class="ttdeci">int</div><div class="ttdef"><b>Definition:</b> <a href="_d_t_p_m__train__model_8py_source.html#l00228">DTPM_train_model.py:228</a></div></div>
<div class="ttc" id="anamespace_d_t_p_m__utils_html_aaa6baa9535ed6c6f892e25bcb546486c"><div class="ttname"><a href="namespace_d_t_p_m__utils.html#aaa6baa9535ed6c6f892e25bcb546486c">DTPM_utils.load_hardware_counters</a></div><div class="ttdeci">def load_hardware_counters()</div><div class="ttdoc">Update the global hardware counter variable with the trace for the hardware counters,...</div><div class="ttdef"><b>Definition:</b> <a href="_d_t_p_m__utils_8py_source.html#l00680">DTPM_utils.py:680</a></div></div>
<div class="ttc" id="anamespace_d_t_p_m__utils_html_a7932918de66e9976e37fc3adbe5355bb"><div class="ttname"><a href="namespace_d_t_p_m__utils.html#a7932918de66e9976e37fc3adbe5355bb">DTPM_utils.get_snippet_deadlines</a></div><div class="ttdeci">def get_snippet_deadlines()</div><div class="ttdoc">Get the deadlines for all snippets.</div><div class="ttdef"><b>Definition:</b> <a href="_d_t_p_m__utils_8py_source.html#l00667">DTPM_utils.py:667</a></div></div>
<div class="ttc" id="anamespace_d_a_s_h___sim__utils_html_a12301b830278c9ed9494270c6557afd3"><div class="ttname"><a href="namespace_d_a_s_h___sim__utils.html#a12301b830278c9ed9494270c6557afd3">DASH_Sim_utils.get_system_state</a></div><div class="ttdeci">def get_system_state(PEs, input_freq=None, input_cores=None)</div><div class="ttdoc">Get the current system state.</div><div class="ttdef"><b>Definition:</b> <a href="_d_a_s_h___sim__utils_8py_source.html#l00237">DASH_Sim_utils.py:237</a></div></div>
<div class="ttc" id="anamespace_d_t_p_m__utils_html_a65bf6bc0b22845b0e75422395ce132ac"><div class="ttname"><a href="namespace_d_t_p_m__utils.html#a65bf6bc0b22845b0e75422395ce132ac">DTPM_utils.add_oracle_to_dataset</a></div><div class="ttdeci">def add_oracle_to_dataset(oracle_type)</div><div class="ttdoc">Read the dataset and add the oracle decision for all samples.</div><div class="ttdef"><b>Definition:</b> <a href="_d_t_p_m__utils_8py_source.html#l00424">DTPM_utils.py:424</a></div></div>
<div class="ttc" id="anamespace_d_t_p_m__utils_html_a3c794b8a9df741fee23a0173d1767bb0"><div class="ttname"><a href="namespace_d_t_p_m__utils.html#a3c794b8a9df741fee23a0173d1767bb0">DTPM_utils.run_parallel_sims</a></div><div class="ttdeci">def run_parallel_sims(DVFS_config_list, N_little_list, N_big_list, N_jobs, N_applications, heterogeneous_PEs=False)</div><div class="ttdoc">Run all possible combinations for the provided frequency points in parallel.</div><div class="ttdef"><b>Definition:</b> <a href="_d_t_p_m__utils_8py_source.html#l00057">DTPM_utils.py:57</a></div></div>
<div class="ttc" id="anamespace_d_t_p_m__power__models_html_a745d2c5771fd1b2bda1ef599bdc2b362"><div class="ttname"><a href="namespace_d_t_p_m__power__models.html#a745d2c5771fd1b2bda1ef599bdc2b362">DTPM_power_models.compute_dynamic_power_dissipation</a></div><div class="ttdeci">def compute_dynamic_power_dissipation(current_frequency, current_voltage, Cdyn_alpha)</div><div class="ttdoc">Compute the dynamic power dissipation for the current task based on the current state of the PE.</div><div class="ttdef"><b>Definition:</b> <a href="_d_t_p_m__power__models_8py_source.html#l00126">DTPM_power_models.py:126</a></div></div>
<div class="ttc" id="anamespace_d_t_p_m__utils_html_ad8283097fe03394692d2c86c14782228"><div class="ttname"><a href="namespace_d_t_p_m__utils.html#ad8283097fe03394692d2c86c14782228">DTPM_utils.update_oracle_dataset</a></div><div class="ttdeci">def update_oracle_dataset(dataset_name, dataset_type)</div><div class="ttdoc">Update datasets with current oracle decisions after the DAgger iteration finishes.</div><div class="ttdef"><b>Definition:</b> <a href="_d_t_p_m__utils_8py_source.html#l00508">DTPM_utils.py:508</a></div></div>
<div class="ttc" id="anamespace_d_t_p_m__utils_html_a869b37f609993178f3feeba27f1a28eb"><div class="ttname"><a href="namespace_d_t_p_m__utils.html#a869b37f609993178f3feeba27f1a28eb">DTPM_utils.get_oracle_frequencies_and_num_cores</a></div><div class="ttdeci">def get_oracle_frequencies_and_num_cores()</div><div class="ttdoc">Create a dictionary that stores the oracle configuration for for each group &lt;Workload,...</div><div class="ttdef"><b>Definition:</b> <a href="_d_t_p_m__utils_8py_source.html#l00394">DTPM_utils.py:394</a></div></div>
<div class="ttc" id="anamespace_d_t_p_m__utils_html_aee85a0d8ebdec96411b002f24fd7deee"><div class="ttname"><a href="namespace_d_t_p_m__utils.html#aee85a0d8ebdec96411b002f24fd7deee">DTPM_utils.find_oracle_group</a></div><div class="ttdeci">def find_oracle_group(arg_list)</div><div class="ttdoc">Return oracle decisions for a given group of snippets.</div><div class="ttdef"><b>Definition:</b> <a href="_d_t_p_m__utils_8py_source.html#l00360">DTPM_utils.py:360</a></div></div>
<div class="ttc" id="anamespace_d_t_p_m__utils_html_a0037071bb37f4eb231443e6ceaba9012"><div class="ttname"><a href="namespace_d_t_p_m__utils.html#a0037071bb37f4eb231443e6ceaba9012">DTPM_utils.sed_inplace</a></div><div class="ttdeci">def sed_inplace(filename, pattern, repl)</div><div class="ttdoc">Perform the pure-Python equivalent of in-place sed substitution: e.g., sed -i -e 's/${pattern}'/'${...</div><div class="ttdef"><b>Definition:</b> <a href="_d_t_p_m__utils_8py_source.html#l00543">DTPM_utils.py:543</a></div></div>
<div class="ttc" id="anamespace_d_t_p_m__utils_html_adde6dd5203b0df388d4dd9c86df8b3fa"><div class="ttname"><a href="namespace_d_t_p_m__utils.html#adde6dd5203b0df388d4dd9c86df8b3fa">DTPM_utils.create_reduced_dataset</a></div><div class="ttdeci">def create_reduced_dataset(oracle_type)</div><div class="ttdoc">Create dataset for leave-one-out experiments, completely remove one application from the dataset,...</div><div class="ttdef"><b>Definition:</b> <a href="_d_t_p_m__utils_8py_source.html#l00467">DTPM_utils.py:467</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="_d_t_p_m__utils_8py.html">DTPM_utils.py</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
